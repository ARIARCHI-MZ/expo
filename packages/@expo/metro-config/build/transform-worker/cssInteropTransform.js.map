{"version":3,"file":"cssInteropTransform.js","names":["_cssToRn","data","require","_metroTransformWorker","_interopRequireDefault","_cssModules","_preprocessors","obj","__esModule","default","cssInteropTransform","config","projectRoot","filename","options","code","cssPreprocessors","nativeStyles","cssToReactNativeRuntime","Buffer","from","matchCssModule","worker","transform","JSON","stringify"],"sources":["../../src/transform-worker/cssInteropTransform.ts"],"sourcesContent":["import { cssToReactNativeRuntime } from '@expo/styling/css-to-rn';\nimport worker, {\n  JsTransformerConfig,\n  JsTransformOptions,\n  TransformResponse,\n} from 'metro-transform-worker';\n\nimport { matchCssModule } from './css-modules';\nimport { cssPreprocessors } from './preprocessors';\n\nexport async function cssInteropTransform(\n  config: JsTransformerConfig & {\n    externallyManagedCss?: Record<string, string>;\n  },\n  projectRoot: string,\n  filename: string,\n  data: Buffer,\n  options: JsTransformOptions\n): Promise<TransformResponse> {\n  const code = await cssPreprocessors(projectRoot, filename, data);\n\n  const nativeStyles = cssToReactNativeRuntime(Buffer.from(code, 'utf8'));\n\n  if (matchCssModule(filename)) {\n    return worker.transform(\n      config,\n      projectRoot,\n      filename,\n      Buffer.from(\n        `module.exports = require(\"@expo/styling\").StyleSheet.create(${JSON.stringify(\n          nativeStyles\n        )});`\n      ),\n      options\n    );\n  } else {\n    return worker.transform(\n      config,\n      projectRoot,\n      filename,\n      Buffer.from(`require(\"@expo/styling\").StyleSheet.register(${JSON.stringify(nativeStyles)});`),\n      options\n    );\n  }\n}\n"],"mappings":";;;;;;AAAA,SAAAA,SAAA;EAAA,MAAAC,IAAA,GAAAC,OAAA;EAAAF,QAAA,YAAAA,CAAA;IAAA,OAAAC,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AACA,SAAAE,sBAAA;EAAA,MAAAF,IAAA,GAAAG,sBAAA,CAAAF,OAAA;EAAAC,qBAAA,YAAAA,CAAA;IAAA,OAAAF,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AAMA,SAAAI,YAAA;EAAA,MAAAJ,IAAA,GAAAC,OAAA;EAAAG,WAAA,YAAAA,CAAA;IAAA,OAAAJ,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AACA,SAAAK,eAAA;EAAA,MAAAL,IAAA,GAAAC,OAAA;EAAAI,cAAA,YAAAA,CAAA;IAAA,OAAAL,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AAAmD,SAAAG,uBAAAG,GAAA,WAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,KAAAE,OAAA,EAAAF,GAAA;AAE5C,eAAeG,mBAAmBA,CACvCC,MAEC,EACDC,WAAmB,EACnBC,QAAgB,EAChBZ,IAAY,EACZa,OAA2B,EACC;EAC5B,MAAMC,IAAI,GAAG,MAAM,IAAAC,iCAAgB,EAACJ,WAAW,EAAEC,QAAQ,EAAEZ,IAAI,CAAC;EAEhE,MAAMgB,YAAY,GAAG,IAAAC,kCAAuB,EAACC,MAAM,CAACC,IAAI,CAACL,IAAI,EAAE,MAAM,CAAC,CAAC;EAEvE,IAAI,IAAAM,4BAAc,EAACR,QAAQ,CAAC,EAAE;IAC5B,OAAOS,+BAAM,CAACC,SAAS,CACrBZ,MAAM,EACNC,WAAW,EACXC,QAAQ,EACRM,MAAM,CAACC,IAAI,CACR,+DAA8DI,IAAI,CAACC,SAAS,CAC3ER,YAAY,CACZ,IAAG,CACN,EACDH,OAAO,CACR;EACH,CAAC,MAAM;IACL,OAAOQ,+BAAM,CAACC,SAAS,CACrBZ,MAAM,EACNC,WAAW,EACXC,QAAQ,EACRM,MAAM,CAACC,IAAI,CAAE,gDAA+CI,IAAI,CAACC,SAAS,CAACR,YAAY,CAAE,IAAG,CAAC,EAC7FH,OAAO,CACR;EACH;AACF"}