{"version":3,"file":"globals.js","sourceRoot":"","sources":["../../../src/runtime/native/globals.ts"],"names":[],"mappings":"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","sourcesContent":["import { createContext } from 'react';\nimport { AccessibilityInfo, Dimensions, Platform, Appearance } from 'react-native';\n\nimport { ContainerRuntime, ExtractedAnimation, StyleMeta, StyleProp } from '../../types';\nimport { createSignal } from './signals';\n\nexport const globalStyles = new Map<string, StyleProp>();\nexport const styleMetaMap = new WeakMap<\n  NonNullable<StyleProp> | NonNullable<StyleProp>[],\n  StyleMeta\n>();\nexport const animationMap = new Map<string, ExtractedAnimation>();\n\nexport const rem = createRem(14);\nexport const vw = viewportUnit('width', Dimensions);\nexport const vh = viewportUnit('height', Dimensions);\nexport const colorScheme = createColorScheme(Appearance);\nexport const isReduceMotionEnabled = createIsReduceMotionEnabled();\n\nexport const VariableContext = createContext<Record<string, any>>({\n  '--tw-border-spacing-x': 0,\n  '--tw-border-spacing-y': 0,\n  '--tw-translate-x': 0,\n  '--tw-translate-y': 0,\n  '--tw-rotate': 0,\n  '--tw-skew-x': '0deg',\n  '--tw-skew-y': '0deg',\n  '--tw-scale-x': 1,\n  '--tw-scale-y': 1,\n});\nexport const ContainerContext = createContext<Record<string, ContainerRuntime>>({});\n\nfunction viewportUnit(key: 'width' | 'height', dimensions: Dimensions) {\n  const signal = createSignal<number>(dimensions.get('window')[key] || 0);\n\n  let subscription = dimensions.addEventListener('change', ({ window }) => {\n    signal.set(window[key]);\n  });\n\n  const get = () => signal.get() || 0;\n  const reset = (dimensions: Dimensions) => {\n    signal.set(dimensions.get('window')[key] || 0);\n    subscription.remove();\n    subscription = dimensions.addEventListener('change', ({ window }) => {\n      signal.set(window[key]);\n    });\n  };\n\n  return { get, reset, __set: signal.set };\n}\n\nfunction createRem(defaultValue: number) {\n  const signal = createSignal<number>(defaultValue);\n\n  const get = () => {\n    if (Platform.OS === 'web' && typeof window !== 'undefined') {\n      const value = Number.parseFloat(\n        window.document.documentElement.style.getPropertyValue('font-size')\n      );\n\n      if (Number.isNaN(value)) {\n        return 16;\n      }\n    }\n\n    return signal.get() || 14;\n  };\n\n  const set = (nextValue: number) => {\n    if (Platform.OS === 'web' && typeof window !== 'undefined') {\n      if (Number.isNaN(nextValue)) {\n        return;\n      }\n\n      window.document.documentElement.style.setProperty('font-size', `${nextValue}px`);\n    } else {\n      signal.set(nextValue);\n    }\n  };\n\n  const reset = () => {\n    set(defaultValue);\n  };\n\n  return { get, set, reset };\n}\n\nfunction createColorScheme(appearance: typeof Appearance) {\n  let isSystem = true;\n  const signal = createSignal<'light' | 'dark'>(appearance.getColorScheme() ?? 'light');\n\n  const set = (colorScheme: 'light' | 'dark' | 'system') => {\n    if (colorScheme === 'system') {\n      isSystem = true;\n      signal.set(appearance.getColorScheme() ?? 'light');\n    } else {\n      isSystem = false;\n      signal.set(colorScheme);\n    }\n  };\n\n  let listener = appearance.addChangeListener(({ colorScheme }) => {\n    if (isSystem) {\n      signal.set(colorScheme ?? 'light');\n    }\n  });\n\n  const reset = (appearance: typeof Appearance) => {\n    listener.remove();\n    listener = appearance.addChangeListener(({ colorScheme }) => {\n      if (isSystem) {\n        signal.set(colorScheme ?? 'light');\n      }\n    });\n    isSystem = true;\n    signal.set(appearance.getColorScheme() ?? 'light');\n  };\n\n  return { get: signal.get, set, reset };\n}\n\nfunction createIsReduceMotionEnabled() {\n  const signal = createSignal(false);\n  AccessibilityInfo.isReduceMotionEnabled()?.then(signal.set);\n  AccessibilityInfo.addEventListener('reduceMotionChanged', signal.set);\n\n  return { ...signal, reset: () => signal.set(false) };\n}\n"]}